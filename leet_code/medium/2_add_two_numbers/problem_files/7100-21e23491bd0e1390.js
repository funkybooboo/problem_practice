"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7100],{2780:(e,n,t)=>{t.d(n,{V:()=>s});var a=t(74848),i=t(82479);let s=e=>{let{cardImg:n,className:t,backgroundColors:s}=e;return(0,a.jsxs)("div",{className:(0,i.xF)("pointer-events-none h-full w-full bg-[#FCFAFE] dark:bg-[#08050D]",t),children:[n&&(0,a.jsx)("img",{src:n,alt:"",className:"h-full w-full object-fill opacity-[0.08] blur-2xl"}),!n&&s&&(0,a.jsx)("div",{className:"h-full w-full opacity-[0.08] blur-2xl",style:{background:`linear-gradient(${s[0]}, ${s[1]})`}}),(0,a.jsx)("div",{className:"dark:to-sd-fixed-black to-sd-fixed-white absolute inset-0 h-full w-full bg-gradient-to-b from-transparent"})]})}},75107:(e,n,t)=>{t.d(n,{S:()=>g});var a=t(74848),i=t(84038),s=t(96540),r=t(82479),l=t(72556),o=t(5596),u=t(3519),d=t(90525),c=t(37163);let g=e=>{let{contestData:n,ongoingStatus:t,className:g,children:m}=e,{t:x}=(0,i.Bd)("contest",{keyPrefix:"rankingPage"}),f=t===o.c.END,{rankingUpdated:v,unrated:p}=n??{},{isContestOngoing:k,isVirtualContest:h}=(0,c.B)(),y=(0,l._)(e=>{e&&d.K.contestRankingRankInfoClick({contest_is_virtual:String(h),contest_is_ongoing:String(k)})}),_=(0,s.useMemo)(()=>f?p?(0,a.jsx)("div",{children:(0,a.jsx)("p",{children:x("rankTipUnrated")})}):v?(0,a.jsx)("div",{children:(0,a.jsx)("p",{children:x("rankTipUpdated")})}):(0,a.jsx)("div",{children:(0,a.jsx)("p",{children:x("rankTipPending")})}):(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:x("rankTipTitle")}),(0,a.jsxs)("ul",{className:"list-disc [&>li]:ml-5",children:[(0,a.jsx)("li",{children:x("rankTip1")}),(0,a.jsx)("li",{children:x("rankTip2")})]})]}),[f,p,v,x]);return(0,a.jsx)(u.m_,{className:(0,r.xF)("max-w-[260px]",g),label:_,onOpenChange:y,children:(0,a.jsx)("div",{children:m})})}},14815:(e,n,t)=>{function a(e){let n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e)??"",t=parseInt(n[1],16),a=parseInt(n[2],16),i=parseInt(n[3],16),s=Math.max(t,a,i),r=Math.min(t,a,i),l=s-r,o=0;switch(s){case r:o=0;break;case t:o=(a-i+l*(a<i?6:0))/(6*l);break;case a:o=(i-t+2*l)/(6*l);break;case i:o=(t-a+4*l)/(6*l)}return{h:360*o,s:100*(0===s?0:l/s),v:s/255*100}}function i(e){let{h:n,s:t,v:a}=e,i=t/100*(a/100),s=(2-t/100)*a/100;return{h:n/360*360,s:100*(i/=s<=1?s:2-s),l:100*(s/=2)}}t.d(n,{W:()=>s});let s=e=>{let{primaryHex:n,secondaryHex:t}=e,{h:s,s:r,v:l}=a(n),o=s>0&&s<=80||s>120&&s<=160||s>240&&s<=320?1:-1,u=s>25&&s<210,d=i({h:s,s:r,v:l}),c=t?i(a(t)):i({h:(s+15*o+360)%360,s:Math.max(r-30,0),v:100}),g=i({h:(s+30*o+360)%360,s:Math.max(r-50,0),v:100});return{"--ranking-primary":`${d.h} ${d.s}% ${d.l}%`,"--ranking-secondary":`${c.h} ${c.s}% ${c.l}%`,"--ranking-highlight":`${g.h} ${g.s}% ${g.l}%`,"--ranking-foreground":u?"0 0% 10%":"0 0% 96%"}}},78287:(e,n,t)=>{t.d(n,{b:()=>A});var a=t(74848),i=t(86715),s=t(37069),r=t(84038),l=t(96540),o=t(31261),u=t(72556),d=t(82479),c=t(85579),g=t(5596),m=t(90525),x=t(72187),f=t(79656),v=t(36698),p=t(63864),k=t(3519),h=t(76033),y=t(28140),_=t(70354),j=t(37763),b=t(37163);let w=e=>{let{children:n,className:t}=e;return(0,a.jsx)("div",{className:(0,d.xF)("even:bg-fill-quaternary flex h-[50px] min-w-[fit-content] items-start rounded-r-lg",t),children:n})},S=e=>{let{questions:n,contestSlug:t,className:i}=e,{t:s}=(0,r.Bd)("contest",{keyPrefix:"rankingPage"}),{isContestOngoing:l,isVirtualContest:o}=(0,b.B)(),d=(0,u._)(()=>{m.K.contestRankingQuestionClick({contest_is_virtual:String(o),contest_is_ongoing:String(l)})}),c=(0,u._)(e=>{e&&m.K.contestRankingTimeInfoClick({contest_is_virtual:String(o),contest_is_ongoing:String(l)})});return(0,a.jsxs)(w,{className:i,children:[(0,a.jsx)(j.NT,{children:s("name")}),(0,a.jsx)(j.Q5,{children:s("score")}),(0,a.jsxs)(j.FU,{className:"flex items-center gap-0.5",children:[(0,a.jsx)("div",{children:s("finishTime")}),(0,a.jsx)(k.m_,{className:"max-w-[240px]",label:s("finishTimeTip"),onOpenChange:c,children:(0,a.jsx)("div",{children:(0,a.jsx)(h.d,{variant:"12px",padding:"square",icon:f.iW_})})})]}),n.map((e,n)=>(0,a.jsx)(j.GG,{children:(0,a.jsxs)(p.N,{href:x.f0.contestQuestion(t,e.titleSlug),isExternal:!0,onClick:d,children:[s("questionPrefix"),n+1," (",e.credit,")"]})},e.id))]})},N=e=>{var n,t,i,s;let{isContestOngoing:r,rankingData:l,contestData:o,isSelf:u,isDetail:c,rankingRegion:g}=e,m=u||!o.isVirtual?null==o?void 0:o.startTime:null==o?void 0:o.originStartTime,x=!!(null===(i=(0,_.Xe)())||void 0===i?void 0:null===(t=i.data)||void 0===t?void 0:null===(n=t.userStatus)||void 0===n?void 0:n.isSignedIn),f=(null===(s=(0,y.y)())||void 0===s?void 0:s.data)&&!r&&x;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.i$,{rankingData:l,isSelf:u,rankingRegion:g,isDetail:c,isVirtual:o.isVirtual}),(0,a.jsx)(j.hm,{score:null==l?void 0:l.score,isDetail:c,className:(0,d.xF)({"w-[80px] min-w-[none] max-w-[none] flex-none":!c})}),(0,a.jsx)(j.qA,{finishTime:null==l?void 0:l.finishTime,startTime:m,className:(0,d.xF)({"w-[100px] min-w-[none] max-w-[none] flex-none":!c})}),c?null==o?void 0:o.questions.map(e=>{var n;return(0,a.jsx)(j.f3,{username:null==l?void 0:l.userStatus.username,userSlug:null==l?void 0:l.userStatus.userSlug,submission:null==l?void 0:l.submissions[e.questionId],dataRegion:null==l?void 0:l.region,hasReplay:(null==l?void 0:null===(n=l.replays)||void 0===n?void 0:n[e.questionId])&&f,questionSlug:e.titleSlug,startTime:m,isSelf:u},e.questionId)}):(0,a.jsx)(j.Ig,{rankingData:l,contestData:o})]})},T=e=>{let{rankingData:n,contestData:t,className:i,isSelf:r,index:o,isDetail:u,isContestOngoing:c,rankingRegion:g}=e,[m,x]=(0,l.useState)(!1),[f,p]=(0,l.useState)(n),k=30*o;return(0,l.useEffect)(()=>{if(!(0,v.A)(n,f)){if(!c){p((0,s.A)(n));return}x(!0),setTimeout(()=>{x(!1),p((0,s.A)(n))},500+k)}},[n]),(0,a.jsx)(w,{className:(0,d.xF)("overflow-hidden",{"from-ranking-primary/0 to-ranking-secondary/20 relative bg-gradient-to-b":r},i),children:(0,a.jsx)("div",{className:(0,d.xF)("flex h-[50px] w-full min-w-[fit-content] items-start","transition-all duration-500 ease-out",{"translate-y-[50px] opacity-0":m}),style:{transitionDelay:m?`${k}ms`:""},children:(0,a.jsx)(N,{isContestOngoing:c,rankingData:f,contestData:t,isSelf:r,isDetail:u,rankingRegion:g})})})};var C=t(75107);let E=e=>{let{className:n}=e;return(0,a.jsx)("svg",{width:"9",height:"6",viewBox:"0 0 9 6",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:n,children:(0,a.jsx)("path",{d:"M5.26562 0.734375L8.26562 3.73438C8.47656 3.94531 8.54688 4.27344 8.42969 4.55469C8.3125 4.83594 8.03125 5.02344 7.75 5.02344H1.75C1.44531 5.02344 1.16406 4.83594 1.04688 4.55469C0.929688 4.27344 1 3.94531 1.21094 3.73438L4.21094 0.734375C4.49219 0.429688 4.98438 0.429688 5.26562 0.734375Z",fill:"currentColor"})})},D=e=>{let{children:n,className:t}=e;return(0,a.jsx)("div",{className:(0,d.xF)("text-text-secondary flex h-[50px] w-[94px] flex-none items-center p-4 pl-7 font-medium",t),children:n})},$=e=>{let{rankingData:n,className:t,isSelf:i,index:r,isContestOngoing:o}=e,[u,c]=(0,l.useState)(!1),[g,m]=(0,l.useState)(n),x=30*r;return(0,l.useEffect)(()=>{if(!(0,v.A)(n,g)){if(!o){m((0,s.A)(n));return}c(!0),setTimeout(()=>{c(!1),m((0,s.A)(n))},500+x)}},[n]),(0,a.jsx)("div",{className:(0,d.xF)("even:bg-fill-quaternary text-text-primary flex h-[50px] w-[94px] flex-none gap-2 overflow-hidden rounded-l-lg font-medium",{"from-ranking-primary/0 to-ranking-secondary/20 relative bg-gradient-to-b":i},t),children:(0,a.jsx)("div",{className:(0,d.xF)("flex h-[50px] w-full items-center gap-2 p-4 pl-3 pr-5","transition-all duration-500 ease-out",{"translate-y-[50px] opacity-0":u}),style:{transitionDelay:u?`${x}ms`:""},children:g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-2",children:g.up&&(0,a.jsx)(E,{className:"text-sd-timer-green w-full"})}),(0,a.jsx)("div",{className:(0,d.xF)({"bg-[linear-gradient(180deg,hsl(var(--ranking-secondary))_7.5%,hsl(var(--ranking-primary))_84%)] bg-clip-text font-bold text-transparent":g.rank<=2}),children:g.rank+1})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-2"}),(0,a.jsx)("div",{className:"bg-fill-quaternary h-[4px] w-[20px] rounded-full"})]})})})},R=e=>{let{rankingsData:n,contestData:t,myRanking:i,isDetail:s,page:l,isContestOngoing:o,hideBody:u,rankingRegion:c,ongoingStatus:g,myRankingIndex:m}=e,{t:x}=(0,r.Bd)("contest",{keyPrefix:"rankingPage"});return(0,a.jsxs)("div",{className:"flex w-[94px] flex-none flex-col",children:[s&&(0,a.jsxs)(D,{className:(0,d.xF)("flex items-center gap-0.5",{"opacity-0":!t.questions.length}),children:[(0,a.jsx)("div",{children:x("rank")}),(0,a.jsx)(C.S,{contestData:t,ongoingStatus:g,children:(0,a.jsx)(h.d,{variant:"12px",padding:"square",icon:f.iW_})})]}),s&&!!i&&(0,a.jsx)($,{rankingData:i,isSelf:!0,index:0,isContestOngoing:o,className:(0,d.xF)("transition-opacity",{"opacity-0":u})}),n.map((e,n)=>(0,a.jsx)($,{rankingData:e,isSelf:!s&&n===m,index:n,isContestOngoing:o,className:(0,d.xF)("transition-opacity",{"opacity-0":u})},`${c}-${l}-${n}`))]})};var I=t(13814);let F=e=>{let{animate:n,width:t,height:i,strokeWidth:s=1}=e,[r]=(0,l.useState)((0,I.BI)()),o=(0,l.useRef)(null);return(0,l.useEffect)(()=>{var e,t;n?null===(e=o.current)||void 0===e||e.beginElement():null===(t=o.current)||void 0===t||t.endElement()},[n]),(0,a.jsxs)("svg",{width:t,height:i,viewBox:`0 0 ${t} ${i}`,xmlns:"http://www.w3.org/2000/svg",className:"absolute inset-0",children:[(0,a.jsx)("defs",{children:(0,a.jsxs)("linearGradient",{id:`stroke-${r}`,x1:"0",x2:"1",y1:"0",y2:"0",gradientTransform:"rotate(-45, 0.5, 0.5)",children:[(0,a.jsx)("animateTransform",{ref:o,attributeName:"gradientTransform",type:"rotate",from:"-45 0.5 0.5",to:"135 0.5 0.5",dur:"4s",repeatCount:"indefinite",begin:"indefinite"}),(0,a.jsx)("stop",{offset:"0.0",stopColor:"hsl(var(--ranking-primary))",stopOpacity:"0"}),(0,a.jsx)("stop",{offset:"0.25",stopColor:"hsl(var(--ranking-primary))"}),(0,a.jsx)("stop",{offset:"0.5",stopColor:"hsl(var(--ranking-highlight))"}),(0,a.jsx)("stop",{offset:"0.75",stopColor:"hsl(var(--ranking-primary))"}),(0,a.jsx)("stop",{offset:"1.0",stopColor:"hsl(var(--ranking-primary))",stopOpacity:"0"})]})}),(0,a.jsx)("rect",{width:`${Math.max(t-s,0)}`,height:`${Math.max(i-s,0)}`,x:`${s/2}`,y:`${s/2}`,rx:"5",ry:"5",strokeWidth:`${s}`,stroke:`url(#stroke-${r})`,fill:"none"})]})};var q=t(6727);let A=e=>{let{contestSlug:n,contestInfo:t,rankingInfo:f,myRankingInfo:v,ongoingStatus:p,rankingRegion:k,isDetail:h,className:y,controlledPage:_,setControlledPage:j}=e,b=(0,i.useRouter)(),{t:w}=(0,r.Bd)("contest",{keyPrefix:"rankingPage"}),[N,C]=(0,l.useState)(null),{width:E,height:D}=(0,o.s)(N),[$,I]=(0,l.useState)(1),A=_??$,L=j??I,O=p===g.c.NOT_START,P=p===g.c.STARTED,M=!!(null==t?void 0:t.isVirtual),B=(0,l.useMemo)(()=>{let e=[];if(P&&!M){var n;let t=25*(A-1);e=(null==f?void 0:null===(n=f.rankings)||void 0===n?void 0:n.slice(t,t+25))??[]}else e=(null==f?void 0:f.rankings)??[];let t=(e=(0,s.A)(e)).length;return e.length=25,e.fill(void 0,t),e},[P,f,A,M]),Q=O||!f||!f.rankings.length,V=null==v?void 0:v.userStatus.userSlug,W=!M&&V?B.findIndex(e=>(null==e?void 0:e.userStatus.userSlug)===V)??-1:-1,G=h||!h&&-1!==W,K=(0,u._)(e=>{m.K.contestRankingPaginationClick({contest_is_virtual:String(M),contest_is_ongoing:String(P),contest_component_location:h?"detail":"qd"}),h?b.push({pathname:x.f0.contestRanking(n,e),query:{region:b.query.region}},void 0,{shallow:!0}):L(e)});return t?(0,a.jsxs)("div",{className:(0,d.xF)("flex flex-col items-center",y),children:[(0,a.jsxs)("div",{className:"text-text-secondary relative flex w-full text-sm font-medium",children:[(0,a.jsx)(R,{rankingsData:B,contestData:t,myRanking:v,isDetail:h,page:A,isContestOngoing:P,hideBody:Q,rankingRegion:k,ongoingStatus:p,myRankingIndex:W}),(0,a.jsx)("div",{className:"w-full !overflow-x-auto",children:(0,a.jsxs)("div",{className:"flex min-w-[fit-content] flex-col",children:[h&&(0,a.jsx)(S,{questions:t.questions,contestSlug:t.titleSlug,className:(0,d.xF)({"opacity-0":!t.questions.length})}),h&&!!v&&(0,a.jsx)(T,{rankingData:v,contestData:t,isSelf:!0,index:0,isDetail:h,isContestOngoing:P,rankingRegion:k,className:(0,d.xF)("transition-opacity",{"opacity-0":Q})}),B.map((e,n)=>(0,a.jsx)(T,{rankingData:e,contestData:t,isSelf:!h&&n===W,index:n,isDetail:h,isContestOngoing:P,rankingRegion:k,className:(0,d.xF)("transition-opacity",{"opacity-0":Q})},`${k}-${A}-${n}`))]})}),!!v&&G&&(0,a.jsx)("div",{className:(0,d.xF)("pointer-events-none absolute h-[50px] w-full transition-opacity",{"top-[50px]":h,"opacity-0":Q}),ref:C,style:h?void 0:{top:`${50*W}px`},children:(0,a.jsx)(F,{width:E??0,height:D??0,animate:P})}),Q&&(0,a.jsx)("div",{className:"text-sd-muted-foreground pointer-events-none absolute left-0 top-0 flex h-[600px] w-full flex-col items-center justify-center gap-4 text-base",children:f||O?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-[46px] leading-[24px]",children:"\uD83E\uDD1E"}),(0,a.jsx)("div",{children:w("emptyRankingPlaceholder")})]}):(0,a.jsx)(q.M,{className:"h-10 w-10"})})]}),(0,a.jsx)("div",{className:"flex h-[50px] w-full flex-none items-center justify-center py-1",children:!!f&&(0,a.jsx)(c.d,{currentPage:A,onChange:K,totalItems:(!M&&P?null==f?void 0:f.rankings.length:null==f?void 0:f.userCount)??0,maxPageItems:6,itemsPerPage:25,className:"gap-1.5 space-x-0",arrowButtonClassName:"p-[5px]",chevronClassName:"w-3.5 h-3.5",pageItemClassName:"h-6 min-w-[24px] text-xs px-2 py-[3px] flex item-center justify-center",activePageItemClassName:"dark:!bg-ranking-primary !bg-ranking-primary dark:!text-ranking-foreground !text-ranking-foreground"})})]}):null}},84499:(e,n,t)=>{t.d(n,{A:()=>y});var a=t(63064),i=t(86715),s=t(55373),r=t.n(s),l=t(96540),o=t(82046),u=t(42014),d=t(70071),c=t(5596),g=t(39614),m=t(304),x=t(13814),f=t(72187),v=t(37163);let p=g.Lb.GLOBAL,k=[g.Lb.LLM,g.Lb.GLOBAL],h=()=>{if(!(0,x.Bd)())return p;let e=r().parse(window.location.search,{ignoreQueryPrefix:!0}).region;return e&&k.includes(e)?e:p},y=e=>{let{contestSlug:n,pageFromRouter:t,enabledContestInfo:s,enabledRankingInfo:r,enabledMyRankingInfo:x}=e,k=(0,a.jE)(),y=h(),[_,j]=(0,l.useState)(y),[b,w]=(0,l.useState)(1),S=(0,i.useRouter)(),{data:N,isLoading:T}=(0,m._)(n),C=(0,l.useCallback)(function(e){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],t={...S.query,region:e};null==t||delete t.contestSlug,null==t||delete t.page,S.replace({pathname:S.asPath.replace(/\?.*$/,""),query:t},void 0,{shallow:n})},[S]),E=(0,l.useCallback)(e=>{b>1?S.push({pathname:f.f0.contestRanking(n,1),query:{region:e}},void 0,{shallow:!0}):C(e)},[n,C,b,S]);(0,l.useEffect)(()=>{if(!T){if(!N&&y===g.Lb.LLM)return C(p,!1);C(y)}},[N,T]);let D=_===g.Lb.LLM;(0,l.useEffect)(()=>{T||j(y)},[T,y]);let{data:$,isInitialLoading:R}=(0,o.c)({contestSlug:n,enabled:s}),I=(0,c.r)($),F=(0,l.useRef)(I),q=I===c.c.STARTED,A=I===c.c.END,L=!!(null==$?void 0:$.isVirtual),{setContestSlug:O,setIsVirtualContest:P,setIsContestOngoing:M}=(0,v.B)(e=>e);(0,l.useEffect)(()=>O(n),[n,O]),(0,l.useEffect)(()=>P(L),[L,P]),(0,l.useEffect)(()=>M(q),[q,M]);let B=L&&!q,{data:Q}=(0,d._)({contestSlug:n,region:_,enabled:x}),{data:V}=(0,u.I)({contestSlug:n,region:_,enabled:r&&!L&&q&&!D}),{data:W}=(0,u.TN)({contestSlug:n,region:_,pagination:b,enabled:r&&(L||A)&&!D,staleTime:B?0:void 0}),G=!L&&q?V:W;return(0,l.useEffect)(()=>{D||(q&&F.current===c.c.NOT_START&&k.invalidateQueries(["contest-info"]),A&&F.current===c.c.STARTED&&(k.invalidateQueries(["contest-ranking-page"]),k.invalidateQueries(["contest-my-ranking"])),F.current=I)},[I]),(0,l.useEffect)(()=>{if(!L||!q||D)return;let e=setInterval(()=>{k.invalidateQueries(["contest-my-ranking"])},6e4);return()=>clearInterval(e)},[L,q,k,D]),(0,l.useEffect)(()=>{t&&t>0&&w(t)},[t]),{isLoading:R,contestInfo:$,myRankingInfo:Q,rankingInfo:G,ongoingStatus:I,setRankingRegion:E,rankingRegion:_,setPage:w,page:b}}},70071:(e,n,t)=>{t.d(n,{_:()=>d,k:()=>g});var a=t(9421),i=t(63064),s=t(96540),r=t(77961),l=t(82616),o=t(98031);let u=e=>{var n,t;return e.my_rank&&void 0!==e.my_rank.rank?{rank:e.my_rank.rank,up:!1,userStatus:{username:e.my_rank.real_name||e.my_rank.username,userSlug:e.my_rank.user_slug??e.my_rank.username,avatar:e.my_rank.avatar_url,color:e.my_rank.color??void 0,badge:e.my_rank.medal?{name:null===(n=e.my_rank.medal)||void 0===n?void 0:n.name,icon:null===(t=e.my_rank.medal)||void 0===t?void 0:t.icon}:void 0},region:e.my_rank.data_region,countryCode:e.my_rank.country_code,countryName:e.my_rank.country_name??"",score:e.my_rank.score,finishTime:e.my_rank.finish_time,submissions:Object.entries((null==e?void 0:e.my_submission)??{}).reduce((e,n)=>{let[t,a]=n;return e[t]={id:a.id,date:a.date,submissionId:a.submission_id,failCount:a.fail_count,lang:a.lang||""},e},{}),replays:e.my_rank.replays??{}}:null},d=e=>{let{contestSlug:n,region:t,enabled:i}=e;return(0,a.I)(["contest-my-ranking",{contestSlug:n,region:t}],()=>l.uE.request(l.vZ.contestMyRanking(n,t)).then(u),{enabled:i})},c=e=>({rank:e.rank,up:e.up,userStatus:{username:e.username,userSlug:e.user_slug,avatar:e.avatar_url,color:e.color??void 0,badge:e.medal?{name:e.medal.name,icon:e.medal.icon}:void 0},region:e.data_region,countryCode:e.country_code,countryName:e.country_name??"",score:e.score,finishTime:e.finish_time,replays:e.replays??{},submissions:Object.entries(e.submissions).reduce((e,n)=>{let[t,a]=n;return e[t]={id:a.id,date:a.date,submissionId:a.submission_id,failCount:a.fail_count,lang:a.lang||""},e},{})}),g=e=>{let{contestSlug:n,region:t,userSlug:a,enabled:l}=e,u=(0,i.jE)(),[d,g]=(0,s.useState)(0);return(0,s.useEffect)(()=>{if(!n||!a||!l)return;let e=new WebSocket(`wss://${o.V_}/myranking/${n}/${a}/?region=${t}`);return e.onclose=e=>{4e3!==e.code&&d<5&&setTimeout(()=>g(e=>e+1),3e3)},e.onmessage=e=>{let a=(0,r.N)(e.data);void 0!==a.rank&&null!==a.rank&&u.setQueryData(["contest-my-ranking",{contestSlug:n,region:t}],()=>c(a))},()=>{e.close(4e3)}},[d,n,a,l,t,u]),(0,s.useEffect)(()=>{g(0)},[n,a,l,t]),null}},5596:(e,n,t)=>{t.d(n,{c:()=>s,r:()=>r});var a=t(96540),i=t(72556),s=function(e){return e[e.NOT_START=0]="NOT_START",e[e.STARTED=1]="STARTED",e[e.END=2]="END",e}({});let r=e=>{let{currentTimeDelta:n,startTime:t,duration:s}=e??{},[r,l]=(0,a.useState)(void 0),o=(0,i._)(()=>{if(!n||!t||!s)return;let e=Math.floor(Date.now()/1e3+n-t);e<0?l(0):e<s?l(1):l(2)});return(0,a.useEffect)(()=>{o();let e=setInterval(o,1e3);return()=>clearInterval(e)},[n,t,s,o]),r}},42014:(e,n,t)=>{t.d(n,{I:()=>d,TN:()=>c,W4:()=>g});var a=t(9421),i=t(63064),s=t(96540),r=t(82616),l=t(77961),o=t(98031);let u=e=>{var n,t;return e.total_rank?{userCount:(null==e?void 0:e.user_num)??0,akStatus:{akCount:(null==e?void 0:null===(n=e.ak_info)||void 0===n?void 0:n.ak_num)??0,akAvatars:(null==e?void 0:null===(t=e.ak_info)||void 0===t?void 0:t.lastest_ak_avatars)??[]},rankings:e.total_rank.map(e=>({rank:e.rank,up:e.up,userStatus:{username:e.username,userSlug:e.user_slug??e.username,avatar:e.avatar_url,color:e.color??void 0,badge:e.medal?{name:e.medal.name,icon:e.medal.icon}:void 0},region:e.data_region,countryCode:e.country_code,countryName:e.country_name??"",score:e.score,finishTime:e.finish_time,submissions:Object.entries(e.submissions).reduce((e,n)=>{let[t,a]=n;return e[t]={id:a.id,date:a.date,submissionId:a.submission_id,failCount:a.fail_count,lang:a.lang||""},e},{}),replays:e.replays}))}:{userCount:0,akStatus:{akCount:0,akAvatars:[]},rankings:[]}},d=e=>{let{contestSlug:n,region:t,enabled:i}=e;return(0,a.I)(["contest-ranking-tops",{contestSlug:n,region:t}],()=>r.uE.request(r.vZ.contestRankingTop({contestTitleSlug:n,region:t})).then(u),{enabled:i})},c=e=>{let{contestSlug:n,region:t,pagination:i=1,enabled:s,staleTime:l}=e;return(0,a.I)(["contest-ranking-page",{contestSlug:n,region:t,pagination:i}],()=>r.uE.request(r.vZ.contestRankingPage({contestTitleSlug:n,region:t,pagination:i})).then(u),{enabled:s,staleTime:l})},g=e=>{let{contestSlug:n,region:t,enabled:a}=e,r=(0,i.jE)(),[d,c]=(0,s.useState)(0);return(0,s.useEffect)(()=>{if(!n||!a)return;let e=new WebSocket(`wss://${o.V_}/ranking/${n}/?region=${t}`);return e.onclose=e=>{4e3!==e.code&&d<5&&setTimeout(()=>c(e=>e+1),3e3)},e.onmessage=e=>{var a;let i=(0,l.N)(e.data);if(!i.total_rank)return;r.setQueryData(["contest-ranking-tops",{contestSlug:n,region:t}],()=>u(i));let s=Math.ceil(((null==i?void 0:null===(a=i.total_rank)||void 0===a?void 0:a.length)??0)/25);for(let e=1;e<s+1;e++){let a=(e-1)*25;r.setQueryData(["contest-ranking-page",{contestSlug:n,region:t,pagination:e}],()=>{var e;return u({...i,total_rank:(null==i?void 0:null===(e=i.total_rank)||void 0===e?void 0:e.slice(a,a+25))??[]})})}},()=>{e.close(4e3)}},[d,n,a,t,r]),(0,s.useEffect)(()=>{c(0)},[n,a,t]),null}},28140:(e,n,t)=>{t.d(n,{y:()=>s});var a=t(9640);let i=t(35593).ELA,s=()=>i(a.nS,{},{select:e=>!!e.enableRankingReplay})},304:(e,n,t)=>{t.d(n,{_:()=>l});var a=t(35593),i=t(9640);let s=()=>["leetcode.cn","leetcode.com","canary.leetcode.com",,"canary.leetcode.cn"].includes(window.location.host)?{biweekly:147,weekly:430}:{biweekly:120,weekly:400},r=(e,n)=>{if(!e)return!1;let t=n.split("-"),a=t[0],i=t[2];if(-1===["biweekly","weekly"].indexOf(a))return!1;let{biweekly:r,weekly:l}=s();return!("biweekly"===a&&Number(i)<r||"weekly"===a&&Number(i)<l)},l=e=>(0,a.uEn)(i.nS,{},{select:n=>r(n.enableLlmRanking,e)})}}]);