(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4862],{64869:(e,t,s)=>{"use strict";s.d(t,{X:()=>o});var n=s(74848);s(96540);let o=function(e){let{ref:t,...s}=e;return(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"1em",height:"1em",fill:"currentColor",ref:t,...s,children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12s4.477 10 10 10a1 1 0 100-2 8 8 0 118-8 1 1 0 102 0z",clipRule:"evenodd"})})}},30845:(e,t,s)=>{"use strict";s.d(t,{Ob:()=>w});var n=s(44745),o=s(87134),i=s(49680),r=s(36698),a=s(15440),l=s(18540),c=s(98031),u=s(13814),d=s(91195),m=s(77961);let h=e=>{let{provider:t,authToken:s,onAuthPassed:n,onAuthFailed:o}=e;if(!t.ws)return;let i=t.ws.onmessage,r=t.ws.onopen;t.ws.onmessage=e=>{let{data:s}=e;if("string"!=typeof s)return;let a=(0,m.N)(s);(null==a?void 0:a.authenticated)?(t.ws.onmessage=i,null==r||r(),null==n||n(t,a)):(t.disconnect(),null==o||o(t,a))},t.ws.onopen=()=>{t.ws.send(s)}},p=e=>{let{document:t,roomId:s,isCreatingNewRoom:n,authToken:o,onAuthPassed:i,onAuthFailed:r}=e,a=c.sk;(0,u.Bd)()&&(a=localStorage.getItem("Y_WEBSOCKET_HOST")??a);let l=new d.$R(a,s,t,{params:n?{new:"true"}:{},maxReconnectRetryCount:8});return h({provider:l,authToken:o,onAuthPassed:i,onAuthFailed:r}),l.on("status",e=>{let{status:t}=e;"connecting"===t&&h({provider:l,authToken:o,onAuthPassed:i,onAuthFailed:r})}),l},g="monaco",b=(0,o.kg)({wsDocument:new i.JA,wsProvider:void 0,authToken:void 0,authPassed:!1,roomId:void 0,role:void 0,userInfo:void 0,followingClientId:null,clientsInRoom:[],failedToJoinType:l.n.None,switchingQuestionInfo:void 0,switchingLangInfo:void 0,isTriggerQuestionChangeByOthers:!1,joinedTimestamp:void 0,isLeavingQdPage:!1,isCreatingNewRoom:!1,isQuestionOrLangChangedActively:!1},(e,t)=>{let s=t=>e(e=>({...e,isCreatingNewRoom:t})),n=t=>e(e=>({...e,role:t})),o=t=>e(e=>({...e,userInfo:t})),l=t=>e(e=>({...e,clientsInRoom:t})),c=t=>e(e=>({...e,authPassed:t})),u=t=>e(e=>({...e,joinedTimestamp:t})),d=e=>{let i=p({document:t().wsDocument,roomId:e,isCreatingNewRoom:t().isCreatingNewRoom,authToken:t().authToken??"",onAuthPassed:(e,t)=>{let{role:i}=t,{avatar:r}=t.userInfo,l=t.userInfo.realName||t.userInfo.username;e.awareness.setLocalStateField("role",i),e.awareness.setLocalStateField("username",l),e.awareness.setLocalStateField("avatar",r),n(i),o({username:l,avatar:r}),u(Date.now()),s(!1),c(!0),a.L.qdCollabJoinClick({qd_collab_role:i})},onAuthFailed:()=>{s(!1)}});return i.awareness.on("change",()=>{let e=i.awareness.states,s=[...(null==e?void 0:e.entries())??[]].map(e=>{let[t,s]=e;return{id:t,username:s.username,avatar:s.avatar,role:s.role}});(0,r.A)(t().clientsInRoom,s)||l(s)}),i},m=t=>e(e=>{var s;null===(s=e.wsProvider)||void 0===s||s.destroy();let n=d(t);return{...e,wsProvider:n,roomId:t}}),h=()=>{e(e=>{var t;return null===(t=e.wsProvider)||void 0===t||t.destroy(),{...e,wsDocument:new i.JA,wsProvider:void 0,authPassed:!1,roomId:void 0,role:void 0,followingClientId:null,clientsInRoom:[],isCreatingNewRoom:!1}})};return{clientId:()=>t().wsDocument.clientID,sharedMonacoText:()=>t().wsDocument.getText(g),sharedEditorState:()=>t().wsDocument.getMap("map"),setAuthToken:t=>e(e=>({...e,authToken:t})),setDocText:t=>e(e=>{let s=e.wsDocument.getText(g);return s.delete(0,s.length),s.insert(0,t),{...e,wsDocument:e.wsDocument}}),setRole:n,joinRoom:e=>{m(e)},closeRoom:()=>{e(e=>(e.wsDocument.getMap("map").set("closeRoom",!0),{...e,wsDocument:e.wsDocument})),setTimeout(()=>t().roomId&&h(),1e3)},setClientsInRoom:l,setFollowingClientId:t=>e(e=>({...e,followingClientId:t})),endCollaboration:h,setFailedToJoinType:t=>e(e=>({...e,failedToJoinType:t})),setSwitchingQuestionInfo:t=>e(e=>({...e,switchingQuestionInfo:t})),setSwitchingLangInfo:t=>e(e=>({...e,switchingLangInfo:t})),setIsTriggerQuestionChangeByOthers:t=>e(e=>({...e,isTriggerQuestionChangeByOthers:t})),setIsLeavingQdPage:t=>e(e=>({...e,isLeavingQdPage:t})),setIsCreatingNewRoom:s,setIsQuestionOrLangChangedActively:t=>e(e=>({...e,isQuestionOrLangChangedActively:t}))}}),w=(0,n.vt)(b)},18540:(e,t,s)=>{"use strict";s.d(t,{n:()=>n});var n=function(e){return e[e.None=0]="None",e[e.Premium=1]="Premium",e[e.MaximumCapacity=2]="MaximumCapacity",e[e.DynamicLayout=3]="DynamicLayout",e[e.NotFound=4]="NotFound",e[e.NotLoggedIn=5]="NotLoggedIn",e[e.JoinedOtherRoom=6]="JoinedOtherRoom",e[e.ConnectionFailedHost=7]="ConnectionFailedHost",e[e.ConnectionFailedGuest=8]="ConnectionFailedGuest",e[e.SameUserInRoom=9]="SameUserInRoom",e[e.NoHost=10]="NoHost",e[e.MaxTime=11]="MaxTime",e[e.CloseRoom=12]="CloseRoom",e}({})},53882:(e,t,s)=>{"use strict";s.d(t,{$:()=>a,z:()=>l});var n=s(74848);s(96540);var o=s(82479),i=s(64869),r=s(36768);let a=function(e){let{ref:t,...s}=e,{variant:a="secondary",readonly:l,onClick:c,loading:u,className:d,block:m,...h}=s,p=h.disabled||u;return(0,n.jsxs)("button",{...h,onClick:l?void 0:c,ref:t,disabled:p,className:(0,o.xF)("rounded px-3 py-1.5 font-medium","items-center whitespace-nowrap","focus:outline-none",{"cursor-not-allowed opacity-50":p||l},{"inline-flex":!m,flex:m},{[(0,o.xF)("text-label-r",r.MY.bgGreenStandard,r.MY.bgGreen3Hover)]:"primary"===a,[(0,o.xF)(r.MY.fill3,!p&&r.MY.fill2Hover,r.MY.label2)]:"secondary"===a,[(0,o.xF)("bg-gray-8 dark:bg-brand-orange",r.MY.labelReverse)]:"black"===a,[(0,o.xF)(r.MY.bgBrandOrange,r.MY.labelReverse)]:"premium"===a,[(0,o.xF)(r.MY.bgRedStandard,r.MY.labelReverse)]:"danger"===a,[(0,o.xF)(r.MY.bgBlueStandard,"hover:bg-dark-blue-s",r.MY.labelReverse)]:"blue"===a},d),children:[u&&(0,n.jsx)(i.X,{className:"mr-2 animate-spin"}),s.children]})},l=function(e){let{ref:t,...s}=e,{variant:a="secondary",loading:l,className:c,...u}=s,d=u.disabled||l;return(0,n.jsxs)("a",{...u,ref:t,className:(0,o.xF)("rounded px-3 py-1.5 font-medium","inline-flex items-center whitespace-nowrap","transition-all focus:outline-none",{"cursor-not-allowed opacity-50":d},{[(0,o.xF)(r.MY.labelReverse,r.MY.labelReverseHover,r.MY.fillBlueStandard)]:"primary"===a,[(0,o.xF)(r.MY.fill3,!d&&r.MY.fill2Hover,r.MY.label2,r.MY.label2Hover)]:"secondary"===a},c),children:[l&&(0,n.jsx)(i.X,{className:"mr-2 animate-spin"}),s.children]})}},9935:(e,t,s)=>{"use strict";s.d(t,{T:()=>c});var n=s(74848),o=s(96540),i=s(96377);let r=e=>e,a=e=>{let{children:t}=e;return(0,n.jsx)(n.Fragment,{children:t})},l=e=>{let{ref:t,...s}=e,{src:l,errPlaceholder:c,children:u,...d}=s,m=l&&r(l),[h,p]=(0,o.useState)(m),g=(0,o.useCallback)(()=>{c&&p(c)},[c,p]),b=function(e,t){let s=(0,o.useRef)(null),[n,i]=(0,o.useState)(!1),r=(0,o.useCallback)(s=>{n||(s.target instanceof HTMLSourceElement?s.target.srcset=e:s.target.src=e,i(!0),null==t||t())},[e,n,t]);return(0,o.useEffect)(()=>{if(s&&s.current){let{complete:n,naturalHeight:o}=s.current;n&&0===o&&(s.current instanceof HTMLSourceElement?s.current.srcset=e:s.current.src=e,null==t||t())}},[e,t]),e?{ref:s,onError:r}:{}}(c?(0,i.z)(c):"",g);(0,o.useEffect)(()=>{p(m)},[m]);let w=null==l?void 0:l.toLowerCase().endsWith("svg");return(0,n.jsx)(a,{isSVG:w,source:h,fallbackProps:b,children:(0,n.jsx)("img",{src:m,ref:t,...d,...b,children:u})})};l.displayName="LcImg";let c=l},70094:(e,t,s)=>{"use strict";s.d(t,{E:()=>n});let n=s(96540).useLayoutEffect},94911:(e,t,s)=>{"use strict";s.d(t,{h:()=>r});var n=s(41990),o=s(96540),i=s(13088);let r=()=>{let{theme:e,forcedTheme:t}=(0,n.D)(),s=(0,i.N)("(prefers-color-scheme: dark)"),[r,a]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{a(!0)},[]),!r||(t?"dark"===t:"dark"===e||"system"===e&&s)}},90005:(e,t,s)=>{"use strict";s.d(t,{I:()=>a});var n=s(96540),o=s(70094);s(74848);let i=new Map,r=(0,n.createContext)({insertCss:e=>{if(!e)return;let[t]=e._getContent()[0],s=i.get(t)||0;if(i.set(t,s+1),!s&&!document.getElementById(t)){let s=document.createElement("style");s.id=t,s.textContent=e._getCss(),document.head.appendChild(s)}return()=>{let e=i.get(t)||0;if(e>1)i.set(t,e-1);else{let e=document.getElementById(t);e&&document.head.removeChild(e),i.delete(t)}}}}),a=e=>{let{insertCss:t}=(0,n.useContext)(r);(0,o.E)(()=>e&&t(e),[t,e])}},13654:(e,t,s)=>{"use strict";s.d(t,{l:()=>i});var n=s(96540),o=s(26934);let i=()=>{let e=(0,n.useCallback)(()=>({width:o.oc?window.innerWidth:void 0,height:o.oc?window.innerHeight:void 0}),[]),[t,s]=(0,n.useState)(e);return(0,n.useEffect)(()=>{if(!o.oc)return!1;function t(){s(e())}return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[e]),t}},96377:(e,t,s)=>{"use strict";function n(e){if(null==e?void 0:e.startsWith("http")){let t=new URL(e);return t.searchParams.set("x-oss-process","image/format,webp"),t.toString()}return`${e}?x-oss-process=image/format,webp`}s.d(t,{z:()=>n})},72187:(e,t,s)=>{"use strict";s.d(t,{VB:()=>d,f0:()=>l,lZ:()=>u,uk:()=>c});var n=s(86715),o=s(55373);let i="https://github.com/LeetCode-Feedback/LeetCode-Feedback",r=()=>location.pathname+location.search+location.hash,a=e=>new URLSearchParams("string"==typeof e?{ref:e}:e).toString(),l={notFound:()=>"/404/",internal:{dbTestcase:()=>"/internal/db-testcase/",tagManagement:()=>"/tools/tag-management/",questionFeedback:()=>"/tools/question-feedback/"},library:()=>"/library",internalContest:()=>"/contest/dashboard/internal-contest",contestDashboard:()=>"/contest/dashboard",contestAdmin:()=>"/contest/admin",emailBatch:()=>"/email_batch/",contest:()=>"/contest/",contestDetail:e=>`/contest/${e}`,examDetail:e=>`/open-exam/${e}`,contestManagement:()=>"/contest-management",contestManagementEdit:e=>`/contest-management/${e}`,contestManagementCreate:()=>"/contest-management/create",contestSponsor:()=>"/business/contact/",surveyManagement:()=>"/tools/surveys",surveyManagementEdit:e=>`/tools/surveys/${e}/edit`,surveyManagementCreate:()=>"/tools/surveys/create",contributeDashboard:()=>"/contribute/dashboard",adminBackend:()=>"/mystic/pluto",otpManager:()=>"/mystic/charon/otp",review:()=>"/manage",dangerZone:()=>"/danger_zone",signIn:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=(0,o.stringify)({next:e||r()});return`/accounts/login/?${t}`},register:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=(0,o.stringify)({next:e||r()});return`/accounts/signup/?${t}`},profile:e=>`/u/${e}`,profileWithBadgeModal:(e,t)=>`/u/${e}/?medal=${t}`,USRankingCNProfile:e=>`https://leetcode.cn/u/${e}`,logOut:()=>"/accounts/logout",newPlayground:e=>`/playground/new/${e}`,problemList:(e,t)=>`/problem-list/${e??""}${t?`?${t}`:""}`,problemset:e=>`/problemset/${e}`,problemsetList:e=>`/problem-list/${e}`,questionDetail:e=>`/problems/${e}/`,questionDetailWithLearningEnvironment:(e,t)=>`/problems/${e}${t?`?${t}`:""}`,questionDetailWithTab:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"description";return`/problems/${e}/${t}`},solutions:(e,t,s,n)=>`/problems/${e}/solutions${t?`/${t}`:""}${s?`/${s}${n?`/comments/${n}`:""}`:""}`,solutionsWithLearningEnvironment:(e,t,s,n,o)=>`/problems/${e}/solutions${s?`/${s}`:""}${n?`/${n}${o?`/comments/${o}`:""}`:""}${t?`?${t}`:""}`,solutionDetailSinglePage:(e,t,s,n,o)=>`/problems/${e}/solution-detail${s?`/${s}`:""}${n?`/${n}${o?`/comments/${o}`:""}`:""}${t?`?${t}`:""}`,discussion:(e,t)=>`/problems/${e}/discussion${t?`/comments/${t}`:""}`,discussionComment:(e,t)=>`/problems/${e}/description/comments/${t}`,solutionEditor:(e,t,s,n)=>`/problems/${e}/post-solution${t?`/${t}`:""}${n?`?submissionId=${n}`:""}`,submissionOverview:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return`/problems/${e}/submissions/${t}${s||location.search}`},submissionDetailSingePage:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return`/problems/${e}/submission-detail/${t}${s||location.search}`},submissionOverviewWithSearch:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return`/problems/${e}/submissions/${t}${s?location.search:""}`},questionSolution:e=>`/problems/${e}/solution`,questionSolutionPreview:e=>`/problems/${e}/solution-preview`,questionSubmissionPreview:(e,t)=>`/problems/${e}/submission-preview/${t}`,questionEditorial:(e,t)=>`/problems/${e}/editorial${t?`?source=${t}`:""}`,questionEditorialWithLearningEnvironment:(e,t)=>`/problems/${e}/editorial${t?`?${t}`:""}`,randomOneQuestion:()=>"/problems/random-one-question/",premium:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=a({...e?{ref:e}:{},...t});return`/subscribe/${s?`?${s}`:""}`},premiumDetail:e=>e?`/subscribe/?${a(e)}`:"/subscribe/",subscription:()=>"/premium/subscription/",subscriptionSuccess:()=>"/premium/subscription/success/",eduAuth:()=>"/premium/edu-auth/",studyPlan:()=>"/study-plan",studyPlanDetail:e=>`/study-plan/${e}`,studyPlanV2:"/studyplan",studyPlanV2MyPlan:"/studyplan/my-plan",studyPlanV2Detail:e=>`/studyplan/${e}`,studyPlanV2HistoryDetail:(e,t)=>`/studyplan/${e}?historyId=${t}`,profileHome:()=>"/profile/",profileResume:()=>"/profile/resume/",profilePreview:()=>"/profile/preview-resume/",chat:()=>"/chat/",account:()=>"/profile/account/",order:e=>`/premium/order/${e}/`,premiumPaymentSuccess:()=>"/premium/success",premiumSurvey:()=>"/premium/survey/",orderList:()=>"/order/",serviceAgreement:()=>"/agreement/",subscriptionAgreement:()=>"/subscription-agreement/",store:()=>"/store/",submissionDetail:e=>`/submissions/detail/${e}/`,home:()=>"/",onboarding:()=>"/onboarding/start/",company:(e,t)=>`/company/${e}${t?`?${t}`:""}`,companyDiscuss:e=>`/discuss/topic/${e}/`,companyTag:e=>`/company/${e}`,discussDetail:e=>`/circle/discuss/${e}/`,articleDetail:e=>`/circle/article/${e}/`,leetbookDetail:e=>`/leetbook/detail/${e}/`,globalRankings:()=>"/contest/globalranking",feedback:()=>`${i}/issues/`,communityRules:()=>"/discuss/general-discussion/324861/LeetCode-Community-Rules",contributeTestcase:e=>`${i}/issues/new?assignees=&labels=&template=bug-report-english.yml&title=${e}`,topicTag:e=>`/tag/${e}/`,topicTagDiscuss:e=>`/discuss/topic/${e}/`,favoriteList:()=>"/problem-list/",uploadFavoriteListCover:()=>"/list/upload/favorite_cover/",uploadImage:()=>"/storage/upload/image",markdownGuide:()=>"/markdown-guide/",supportLink:()=>"https://support.leetcode.com/hc/en-us/requests/new",medal:(e,t)=>`/medal/?showImg=${e}${t?`${t}`:""}`,earlyAccess:()=>"/new/",contestRanking:(e,t)=>`/contest/${e}/ranking/${t?`${t}/`:""}`,contestRankingLlmReport:(e,t,s)=>`/contest/${e}/llm-report/${t}/${s||""}`,contestQuestion:(e,t)=>`/contest/${e}/problems/${t}/`,progress:()=>"/progress/",subscriptionManagement:()=>"/subscription/",discuss:()=>"/discuss/",discussTopic:e=>`/discuss/topic/${e}/`,discussPostDetail:(e,t)=>`/discuss/post/${e}/${t?`${t}/`:""}`,discussPostManagementDetail:(e,t)=>`/discuss/post-management/${e}/${t?`${t}/`:""}`,discussPostDetailComment:(e,t,s)=>`/discuss/post/${e}/${t}/comment/${s}/`,discussPostManagementDetailComment:(e,t,s)=>`/discuss/post-management/${e}/${t}/comment/${s}/`,createMdDiscussPost:e=>`/discuss/create/${e?`?topic=${e}`:""}`,editMdDiscussPost:(e,t)=>`/discuss/edit/${t}/${e}/`,createRichTextDiscussPost:e=>`/post-editor/discuss/create/${e?`?topic=${e}`:""}`,editRichTextDiscussPost:(e,t)=>`/discuss/edit/${t}/${e}/`},c="https://support.leetcode.cn/hc/request/new/",u="https://support.leetcode.cn/hc/kb/section/1198435/",d=(e,t,s,o,i)=>{let{query:r}=(0,n.useRouter)();return(r.solution?l.solutionDetailSinglePage:l.solutionsWithLearningEnvironment)(e,t,s,o,i)}},86262:(e,t,s)=>{"use strict";s.d(t,{T:()=>n});var n=function(e){return e.LandingPagePremiumLink="lp_pl",e.NavbarOldPremiumLink="nb_opl",e.StoreOldPremiumLink="sto_opl",e.NavbarNewPremiumLink="nb_npl",e.StoreNewPremiumLink="sto_npl",e.UserMenuPremiumLink="um_pl",e.MockInterviewCompanyModal="mi_cm",e.QuestionDetailPremiumQuestion="qd3_pq",e.QuestionDetailPremiumSolution="qd3_ps",e.QuestionDetailPremiumVideoSolution="qd3_pvs",e.QuestionDetailCompanyModal="qd3_cm",e.QuestionDetailLightningJudger="qd3_lj",e.QuestionDetailSubmitRateLimit="qd3_srl",e.QuestionDetailAutocomplete="qd3_ac",e.QuestionDetailDebuggerTab="qd3_dt",e.QuestionDetailAiHelper="qd3_ai",e.QuestionDetailLayoutManager="qd3_lm",e.QuestionDetailCloudStorage="qd3_cs",e.QuestionDetailAdvanceSettings="qd3_adv",e.ProblemsetFrequency="ps_fq",e.ProblemsetPremiumQuestion="ps_pq",e.ProblemsetCompanyTag="ql_ct",e.ProblemsetFilterCompanyTag="ql_fct",e.ExplorePremiumCardStartButton="ex_pcs",e.ExplorePremiumItem="ex_pi",e.ExplorePremiumSolution="ex_ps",e.ExploreVACPremium="ex_vac",e.StudyPlanV2PremiumPlan="sp2_pp",e.StudyPlanV2PremiumGroup="sp2_pg",e.StudyPlanV2PremiumGroupCalendar="sp2_pc",e.PremiumBetaFeature="pb_f",e.AdSenseRemove="ad_rm",e.ComplexityAnalysis="complexity_analysis",e.CompanyUpgrade="company_upgrade",e.QuestionDetailCollabMode="qd3_clm",e.SmartListFilter="smart_list_filter",e.SmartListSort="smart_list_sort",e.FrequencyLock="frequency_lock",e.SmartListFilterEdit="smart_list_filter_edit",e.StudyPlanCard="sp_cd",e}({})},77961:(e,t,s)=>{"use strict";s.d(t,{N:()=>o});var n=s(83741);let o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null==e)return null===e&&t.allowNull?null:void 0;try{return JSON.parse(e)}catch(t){(0,n.v4)(s=>{s.setTag("source","safeParseJson"),s.setExtra("jsonStr",e),(0,n.Cp)(t)});return}}},91195:(e,t,s)=>{"use strict";s.d(t,{$R:()=>D,BA:()=>$,c7:()=>w,io:()=>y,kj:()=>g,nj:()=>b,u9:()=>_,uu:()=>f,yy:()=>v});var n=s(56615),o=s(62132),i=s(58775),r=s(25968),a=s(57724),l=s(13861),c=s(42946),u=s(31116),d=s(63043),m=s(54972),h=s(93254),p=s(65606);let g=4001,b=4002,w=4003,v=4004,$=4005,f=4006,y=4007,_=4008,C=[];C[0]=(e,t,s,n,o)=>{i.zd(e,0);let r=a.VU(t,e,s.doc,s);n&&r===a.Zg&&!s.synced&&(s.synced=!0)},C[3]=(e,t,s,n,o)=>{i.zd(e,1),i.Gu(e,c.X3(s.awareness,Array.from(s.awareness.getStates().keys())))},C[1]=(e,t,s,n,o)=>{c.tQ(s.awareness,r.bo(t),s)},C[2]=(e,t,s,n,o)=>{l.gU(t,s.doc,(e,t)=>x(s,t))};let x=(e,t)=>console.warn(`Permission denied to access ${e.url}.
${t}`),P=(e,t,s)=>{let n=r.$C(t),o=i.xv(),a=r.cw(n),l=e.messageHandlers[a];return l?l(o,n,e,s,a):console.error("Unable to compute message"),o},S=e=>{if(e.shouldConnect&&null===e.ws){let t=new e._WS(e.url);t.binaryType="arraybuffer",e.ws=t,e.wsconnecting=!0,e.wsconnected=!1,e.synced=!1,t.onmessage=s=>{e.wsLastMessageReceived=o._g();let n=P(e,new Uint8Array(s.data),!0);i.Bw(n)>1&&t.send(i.Fo(n))},t.onerror=t=>{e.emit("connection-error",[t,e])},t.onclose=t=>{e.emit("connection-close",[t,e]),e.ws=null,e.wsconnecting=!1,e.wsconnected?(e.wsconnected=!1,e.synced=!1,c._g(e.awareness,Array.from(e.awareness.getStates().keys()).filter(t=>t!==e.doc.clientID),e),e.emit("status",[{status:"disconnected"}])):e.wsUnsuccessfulReconnects++,[g,b,w,v,$,f].includes(t.code)||(e._maxReconnectRetryCount>0&&e.wsUnsuccessfulReconnects>e._maxReconnectRetryCount&&(e.shouldConnect=!1,e.wsUnsuccessfulReconnects=0,e.emit("status",[{status:"disconnected"}]),e.emit("connection-error-max-retry",[t,e])),setTimeout(S,d.jk(100*d.n7(2,e.wsUnsuccessfulReconnects),e.maxBackoffTime),e))},t.onopen=()=>{e.wsLastMessageReceived=o._g(),e.wsconnecting=!1,e.wsconnected=!0,e.wsUnsuccessfulReconnects=0,e.emit("status",[{status:"connected"}]);let s=i.xv();if(i.zd(s,0),a.ue(s,e.doc),t.send(i.Fo(s)),null!==e.awareness.getLocalState()){let s=i.xv();i.zd(s,1),i.Gu(s,c.X3(e.awareness,[e.doc.clientID])),t.send(i.Fo(s))}},e.emit("status",[{status:"connecting"}])}},k=(e,t)=>{let s=e.ws;e.wsconnected&&s&&s.readyState===s.OPEN&&s.send(t),e.bcconnected&&n.mk(e.bcChannel,t,e)};class D extends u.c{constructor(e,t,s,{connect:r=!0,awareness:l=new c.ww(s),params:u={},WebSocketPolyfill:d=WebSocket,resyncInterval:g=-1,maxBackoffTime:b=2500,disableBc:w=!1,maxReconnectRetryCount:v=-1}={}){for(super();"/"===e[e.length-1];)e=e.slice(0,e.length-1);let $=m.V(u);this.maxBackoffTime=b,this.bcChannel=e+"/"+t,this.url=e+"/"+t+(0===$.length?"":"?"+$),this.roomname=t,this.doc=s,this._WS=d,this.awareness=l,this.wsconnected=!1,this.wsconnecting=!1,this.bcconnected=!1,this.disableBc=w,this.wsUnsuccessfulReconnects=0,this.messageHandlers=C.slice(),this._synced=!1,this.ws=null,this.wsLastMessageReceived=0,this.shouldConnect=r,this._resyncInterval=0,g>0&&(this._resyncInterval=setInterval(()=>{if(this.ws&&this.ws.readyState===WebSocket.OPEN){let e=i.xv();i.zd(e,0),a.ue(e,s),this.ws.send(i.Fo(e))}},g)),this._maxReconnectRetryCount=v,this._bcSubscriber=(e,t)=>{if(t!==this){let t=P(this,new Uint8Array(e),!1);i.Bw(t)>1&&n.mk(this.bcChannel,i.Fo(t),this)}},this._updateHandler=(e,t)=>{if(t!==this){let t=i.xv();i.zd(t,0),a.f7(t,e),k(this,i.Fo(t))}},this.doc.on("update",this._updateHandler),this._awarenessUpdateHandler=(e,t)=>{let{added:s,updated:n,removed:o}=e,r=s.concat(n).concat(o),a=i.xv();i.zd(a,1),i.Gu(a,c.X3(l,r)),k(this,i.Fo(a))},this._exitHandler=()=>{c._g(this.awareness,[s.clientID],"app closed")},h.Ll&&void 0!==p&&p.on("exit",this._exitHandler),l.on("update",this._awarenessUpdateHandler),this._checkInterval=setInterval(()=>{this.wsconnected&&3e4<o._g()-this.wsLastMessageReceived&&this.ws.close()},3e3),r&&this.connect()}get synced(){return this._synced}set synced(e){this._synced!==e&&(this._synced=e,this.emit("synced",[e]),this.emit("sync",[e]))}destroy(){0!==this._resyncInterval&&clearInterval(this._resyncInterval),clearInterval(this._checkInterval),this.disconnect(),void 0!==p&&p.off("exit",this._exitHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.doc.off("update",this._updateHandler),super.destroy()}connectBc(){if(this.disableBc)return;this.bcconnected||(n.B1(this.bcChannel,this._bcSubscriber),this.bcconnected=!0);let e=i.xv();i.zd(e,0),a.ue(e,this.doc),n.mk(this.bcChannel,i.Fo(e),this);let t=i.xv();i.zd(t,0),a.nh(t,this.doc),n.mk(this.bcChannel,i.Fo(t),this);let s=i.xv();i.zd(s,3),n.mk(this.bcChannel,i.Fo(s),this);let o=i.xv();i.zd(o,1),i.Gu(o,c.X3(this.awareness,[this.doc.clientID])),n.mk(this.bcChannel,i.Fo(o),this)}disconnectBc(){let e=i.xv();i.zd(e,1),i.Gu(e,c.X3(this.awareness,[this.doc.clientID],new Map)),k(this,i.Fo(e)),this.bcconnected&&(n.al(this.bcChannel,this._bcSubscriber),this.bcconnected=!1)}disconnect(){this.shouldConnect=!1,this.disconnectBc(),null!==this.ws&&this.ws.close()}connect(){this.shouldConnect=!0,this.wsconnected||null!==this.ws||(S(this),this.connectBc())}}},81635:()=>{}}]);